!function(e){var o={};function t(n){if(o[n])return o[n].exports;var c=o[n]={i:n,l:!1,exports:{}};return e[n].call(c.exports,c,c.exports,t),c.l=!0,c.exports}t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var c in e)t.d(n,c,function(o){return e[o]}.bind(null,c));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=9)}({9:function(e,o){jQuery(document).ready((function(e){var o=window.pagenow.length?window.pagenow:"";if(window.typenow.length&&window.typenow,"edit-product"===o){var t=!1;e("input#doaction, input#doaction2").on("click",(function(o){if(t)return!0;o.preventDefault();var n=e(this),c=n.prev("select").val();if("facebook_include"===c){var i=[];e.each(e('input[name="post[]"]:checked'),(function(){i.push(parseInt(e(this).val(),10))})),e.post(facebook_for_woocommerce_products_admin.ajax_url,{action:"facebook_for_woocommerce_set_product_sync_bulk_action_prompt",security:facebook_for_woocommerce_products_admin.set_product_sync_bulk_action_prompt_nonce,toggle:c,products:i},(function(o){o&&!o.success?(closeExistingModal(),new e.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:o.data})):(t=!0,n.trigger("click"))}))}else t=!0,n.trigger("click")}))}if("product"===o){function n(e,o){o.find(".enable-if-sync-enabled").prop("disabled",!e)}function c(e,o){e?(o.find("option[value='sync_and_show']").show(),o.prop("original")&&o.val(o.prop("original"))):(o.find("option[value='sync_and_show']").hide(),"sync_and_show"===o.val()&&o.val("sync_and_hide"))}function i(e,o){var t=o.find("#wc_facebook_commerce_enabled"),n=t.prop("original");t.prop("checked",!!e&&n).prop("disabled",!e),t.trigger("change"),t.prop("original",n),o.find("#product-not-ready-notice, #variable-product-not-ready-notice").hide(),l()&&!r()?o.find("#variable-product-not-ready-notice").show():e||o.find("#product-not-ready-notice").show()}function a(){return!!(l()?r():"sync_disabled"!==_.val())&&!!(l()||(e("#_regular_price").val()||e("#fb_product_price").val()))&&!(!e("#_manage_stock").prop("checked")||!e("#_stock").val())}function r(){var o=e(".js-variable-fb-sync-toggle");return 0===o.length?!!facebook_for_woocommerce_products_admin.is_sync_enabled_for_product:!!o.map((function(o,t){return"sync_disabled"!==e(t).val()?t:null})).length}function l(){var o=e("select#product-type").val();return!(!o||!o.match(/variable/))}function s(e){e.attr("data-original-value",e.val())}function d(o){return _===o?e("input#post_ID").val():o.closest(".woocommerce_variation").find("input[name^=variable_post_id]").val()}function u(o){f=f.filter((function(e){return e!==o})),e(facebook_for_woocommerce_products_admin.product_removed_from_sync_field_id).val(f.join(","))}var f=[];e("#facebook_options #wc_facebook_commerce_enabled").on("change",(function(){var o=e(this).prop("checked");o?e(".wc_facebook_commerce_fields").show():e(".wc_facebook_commerce_fields").hide(),e(".product_attributes").find(".woocommerce_attribute").length?e(".show_if_has_attributes").show():e(".show_if_has_attributes").hide(),e(this).prop("original",o)})).trigger("change");var _=e("#wc_facebook_sync_mode"),p=_.closest(".woocommerce_options_panel");s(_),_.on("change",(function(){var e="sync_disabled"!==_.val();n(e,p),e&&u(d(_)),_.prop("original",_.val())})).trigger("change"),e("#_virtual").on("change",(function(){c(!e(this).prop("checked"),_)})).trigger("change"),e("input[name=_visibility]").on("change",(function(){"hidden"!==e(this).val()&&"search"!==e(this).val()&&"sync_disabled"===_.val()&&_.val("sync_and_show").trigger("change")}));var m=e("#woocommerce-product-data");m.on("change","#_regular_price, #_manage_stock, #_stock, #wc_facebook_sync_mode, #fb_product_price",(function(o){setTimeout((function(){i(a(),e("#facebook_options"))}),1)})),e(".woocommerce_variations").on("change",".js-variable-fb-sync-toggle",(function(){var o=e(this),t="sync_disabled"!==o.val();n(t,o.closest(".wc-metabox-content")),i(a(),e("#facebook_options")),t&&u(d(o)),o.prop("original",o.val())})),m.on("woocommerce_variations_loaded",(function(){m.find(".js-variable-fb-sync-toggle").each((function(o,t){var c=e(t);n("sync_disabled"!==c.val(),c.closest(".wc-metabox-content")),c.prop("original",c.val()),s(c)})),e(".variable_is_virtual").on("change",(function(){var o=e(this).closest(".wc-metabox-content").find(".js-variable-fb-sync-toggle");c(!e(this).prop("checked"),o)})),i(a(),e("#facebook_options"))})),m.on("change",".js-fb-product-image-source",(function(){var o=e(this).closest(".woocommerce_options_panel, .wc-metabox-content"),t=e(this).val();o.find(".product-image-source-field").closest(".form-field").hide(),o.find(".show-if-product-image-source-".concat(t)).closest(".form-field").show()})),e(".js-fb-product-image-source:checked").trigger("change"),m.on("woocommerce_variations_loaded",(function(){e(".js-variable-fb-sync-toggle:visible").trigger("change"),e(".js-fb-product-image-source:checked").trigger("change"),e(".variable_is_virtual:visible").trigger("change")})),e("#facebook_options").on("click","#product-not-ready-notice-open-modal",(function(o){o.preventDefault(),closeExistingModal(),new e.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:{message:facebook_for_woocommerce_products_admin.product_not_ready_modal_message,buttons:facebook_for_woocommerce_products_admin.product_not_ready_modal_buttons}})})),i(a(),p);var v,b=e("#open_media_library"),g=e("#fb_product_video_selected_thumbnails"),h=e("#fb_product_video"),w=h.val()?h.val().split(",").map(Number):[];function y(){h.val(w.join(","))}function k(e,o){w=w.filter((function(o){return o!==e})),y(),o.remove()}b.on("click",(function(o){o.preventDefault(),v||((v=wp.media({title:"Select videos",button:{text:"Save"},library:{type:"video"},multiple:!0})).on("open",(function(){var e=v.state().get("selection");w.forEach((function(o){var t=wp.media.attachment(o);t.fetch(),e.add(t?[t]:[])}))})),v.on("select",(function(){var o,t,n,c;o=v.state().get("selection"),t=o.map((function(e){return e.id})),n=w.filter((function(e){return!t.includes(e)})),c=t.filter((function(e){return!w.includes(e)})),g.find(".form-field").each((function(){var o=e(this),t=parseInt(o.find("span").data("attachment-id"),10);n.includes(t)&&k(t,o)})),o.each((function(o){if(o=o.toJSON(),c.includes(o.id)&&o.mime&&o.mime.startsWith("video/")){var t=function(o){var t=e("<p>",{class:"form-field video-thumbnail"}),n=e("<img>",{src:o.icon}),c=e("<span>",{text:o.url,"data-attachment-id":o.id}),i=e("<a>",{href:"#",text:"Remove",class:"remove-video"});return i.on("click",(function(e){e.preventDefault(),k(o.id,t)})),t.append(n,c,i),t}(o);g.append(t),w.push(o.id)}else o.mime.startsWith("video/")||alert("Please select a valid video file.")})),y()}))),v.open()})),g.on("click",".remove-video",(function(o){o.preventDefault();var t=e(this);k(t.data("attachment-id"),t.closest(".form-field"))}))}}))}});